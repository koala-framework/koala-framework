'use strict';
const fs = require('fs');
const glob = require("glob");
const ini = require('ini');
const path = require('path');

module.exports = function(webPath = ".") {
    const cwd = process.cwd();

    let ret = {
        web: path.resolve(cwd, webPath),
        webComponents: path.resolve(cwd, `${webPath}/components`),
        webThemes: path.resolve(cwd, `${webPath}/themes`),
        tinymce: path.resolve(cwd, `${webPath}/vendor/bower_components/tinymce/js/tinymce/classes`),
        kwf: path.resolve(cwd, `${webPath}/vendor/koala-framework/koala-framework`)
    };

    glob.sync('vendor/*/*/dependencies.ini').forEach(i => {
        let dependencies = fs.readFileSync(i, 'utf-8');
        dependencies = ini.parse(dependencies);
        if (dependencies.config && dependencies.config.pathType) {
            ret[dependencies.config.pathType] = i.substr(0, i.length-17);
        }
    });


    for (let i in ret) {
        ret[i] = path.resolve(cwd, ret[i]);
    }

    ret.jQuery = 'jquery';

    return ret;
};
