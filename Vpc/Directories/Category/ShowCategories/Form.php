<?phpclass Vpc_Directories_Category_ShowCategories_Form extends Vpc_Abstract_Composite_Form{    protected function _initFields()    {        parent::_initFields();        $showDirectoryClass = Vpc_Abstract::getSetting($this->getClass(), 'showDirectoryClass');        $hideDirectoryClasses = Vpc_Abstract::getSetting($this->getClass(), 'hideDirectoryClasses');        $p = Vps_Model_Abstract::getInstance('Vps_Util_Model_Pool');        $categories = Vps_Component_Data_Root::getInstance()                ->getComponentsByClass('Vpc_Directories_Category_Directory_Component');        // Todo: auf cards umstellen        $values = array();        foreach ($categories as $category) {            $pool = Vpc_Abstract::getSetting($category->componentClass, 'pool');            $itemDirectory = $category->parent;            if (is_instance_of($itemDirectory->componentClass, $showDirectoryClass)) {                foreach ($hideDirectoryClasses as $c) {                    if (is_instance_of($itemDirectory->componentClass, $c)) {                        continue 2;                    }                }                foreach ($p->getRows($p->select()->whereEquals('pool', $pool)) as $cat) {                    $values[$itemDirectory->dbId.'#'.$cat->id] = $itemDirectory->getTitle().' - '.$cat->__toString();                }            }        }        $this->add(new Vps_Form_Field_MultiCheckbox(                'Vpc_Directories_Category_ShowCategories_Model', trlVps('Categories'))            )->setValues($values)            ->setReferences(array(                'columns' => array('component_id'),                'refColumns' => array('id')            ))            ->setColumnName('category');    }}